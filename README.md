# Flow Log Parser

## Project Overview
This project parses a flow log file and applies tags to each flow based on a lookup table of `dstport` and `protocol` combinations. The results are outputted as two counts:
1. Count of matches for each tag.
2. Count of matches for each `dstport`/`protocol` combination.

## Assumptions
- The program only supports version 2 flow logs.
- The flow log input is a plain ASCII text file.
- The lookup table maps port and protocol combinations to tags in a case-insensitive manner.
- Entries that don't match any port/protocol in the lookup table are marked as "Untagged".
- Here I am assuming the file name will not change so that I am not passing as an argument parameter.

## How to Run the Program
To run the program, follow these steps:
1. Ensure you have Python installed on your machine.
2. Clone this repository:

git clone https://github.com/nbhatt537/oa_Illumio.git


3. Navigate into the project directory:

    cd OA_IL

4. Run the program:
    python OA_IL.py


Once executed, the program generates an output file `output.csv` that looks like this:
Tag Counts:
Tag,Count
Untagged,8
sv_P2 ,1
sv_P1 ,2
email ,3

Port/Protocol Combination Counts:
Port,Protocol,Count
49153,tcp,1
49154,tcp,1
49155,tcp,1
49156,tcp,1
49157,tcp,1
49158,tcp,1
80,tcp,1
1024,tcp,1
443,tcp,1
23,tcp,1
25,tcp,1
110,tcp,1
993,tcp,1
143,tcp,1


# Files
- `OA_IL.py`: The main script that processes the flow logs and lookup table.
- `flow_logs.txt`: Sample flow logs in plain text format.
- `lookup_table.csv`: The lookup table mapping `dstport` and `protocol` to tags.
- `output.csv`: The output file generated by the program (optional).

## Tests
I have tested the program with:
- Various combinations of `dstport` and `protocol`.
- Edge cases, such as missing or incorrect values in the lookup table or log file.
- Large files up to 10MB to ensure performance is acceptable.

## Dependencies
- Python 3.x (No non-default packages required).

## Future Improvements
- Add support for custom flow log versions.
- Handle non-ASCII characters in the input files.


## Code Explaination
- Here First of all I had defined the two files i.e flow_logs.txt and lookup_table.csv as an input and output.csv file as a output.
- After that I call the function   `parse_lookup_table`with  a lookup file as a parameter.
- in an parse_lookup_table I had created a dictionary variable named `lookup`. After that I had imported the csv lib and I open the look up file in a read mode and read the value `destination port number and Protocol`. I try to make both as a key and store the tag as value. I had handle the catch cases. 
-  After that I had called `parse_flow_logs(flow_log_file, lookup)` in which flow_log file and dictionary from parse_lookup_table which is lookup.
- I tried to read the file flow_log_file.txt and split with space. After that I try to read the destination port and make assumption that if port no is 6 then tcp else udp.Combination of both will be treated as a key.
- I try to find in a dictionary and if I do not find any value then I assign it as unassigned and calculate the tag count also.
- After that I called write_file function which write data in to file.


